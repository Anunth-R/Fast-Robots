---
layout: default
title: Lab 12
---

# Introduction

Instead of going the traditional route of doing localization, I was inspired by Stephen Wagner's final project of balancing the car as an inverted pendulum. However, he was able to only get the car to balance when it started near a vertical position. In his final thoughts, he stated that it would be cool if a future reader was able to get the car to flip up on its own and balance itself. Therefore, I decided to form a group with Aravind Ramaswami and Nita Kattimani to tackle this challenge.

# Approach

We broke making a robot flip up on its own and balance itself, we first modeled the robot as a non-linear dynamic model and linearized it about its its vertical equilibrium point. Using this model, we constructed a Kalman Filter observer to estimate the state of the robot. We also used pole placement to derive state space controller gains that stabalize the system. To actually get the car to flip upward, we created an open loop controller that causes the car to flip. Finally, we created a state machine which activates all of these pieces at the correct time to allow the car to successfully preform the maneuver. 

# System Modeling

## Problem Setup

We modeled our car balancing problem as a wheel with a rod attached to it. Therefore, we can describe our system using the following state vector consisting of the cart's x position, velocity, theta, and angular velocity.

<img src="https://github.com/user-attachments/assets/1513a67a-173e-4aca-acf5-7c09951dcfb9" width="200">

Then, we can define the following parameters:

<img src="https://github.com/user-attachments/assets/afb94cf0-c44e-4ca1-8a8f-7f3e36674023" width="200">

With these parameters, we can define the following quantities for the position of the center of mass of the system. 

<img src="https://github.com/user-attachments/assets/a13aadd2-f3b7-4a03-832f-f8b6a4f173a2" width="200">

## Energy Definitions

We are going to take a lagrangian mechanics approach to deriving the equations of motion of our system. In particular, we can express the kinetic energy of the wheel using the following expression.

<img src="https://github.com/user-attachments/assets/756bcd62-b7bc-4a1d-979b-e265e5928644" width="200">

Next, we can express the kinetic energy of the rod using the following expression. 

<img src="https://github.com/user-attachments/assets/905f6ff6-f7ac-441a-8833-f9d9f36cccf6" width="200">

Finally, we can express the potential energy of the rod with the expression below.

<img src="https://github.com/user-attachments/assets/d6d5a3c3-f129-4d97-bf91-f871b7f26dda">

With these expressions, the lagrangian can be calculated by substracting the kinetic energy from the potential energy.

![image](https://github.com/user-attachments/assets/d7beab5e-14bc-407e-a1b3-e974a1344e4d)

## Euler-Legrange Equation

Next, we need to apply the Euler-Legrange equation to each coordinate of our system (x and theta). 

x:

<img src="https://github.com/user-attachments/assets/9ab87b70-0f2e-4939-a906-31b143c8a25a">

theta: 

<img src="https://github.com/user-attachments/assets/93fab51b-8d4f-45e9-a3e5-596c89a0fac7">

## Linearizing Equations of Motion

The coupled differential equations for x and theta are shown below. 

![image](https://github.com/user-attachments/assets/ca99643e-862e-4ea3-8aa1-4c99aad07776)

We will linearize these equations about an upright position which in our case is theta = 0. To do this, we will make the following small angle approximations.

![image](https://github.com/user-attachments/assets/1df83887-ef4a-4018-97b2-2315e03c25c2)

This gives us the following linear differential equations.

















